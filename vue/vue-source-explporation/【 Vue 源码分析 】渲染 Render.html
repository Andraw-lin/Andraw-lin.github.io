<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æ¸²æŸ“ Render åŠŸèƒ½</title>
    <meta name="generator" content="VuePress 1.6.0">
    
    <meta name="description" content="å¥½å¥½å­¦ä¹ ï¼Œå¤©å¤©å‘ä¸ŠğŸ’ª">
    <link rel="preload" href="/assets/css/0.styles.a748b10c.css" as="style"><link rel="preload" href="/assets/js/app.62b9dc26.js" as="script"><link rel="preload" href="/assets/js/2.1177bb59.js" as="script"><link rel="preload" href="/assets/js/106.9ccab627.js" as="script"><link rel="prefetch" href="/assets/js/10.a3eb2dd7.js"><link rel="prefetch" href="/assets/js/100.a0587a90.js"><link rel="prefetch" href="/assets/js/101.bc61ee8e.js"><link rel="prefetch" href="/assets/js/102.6c9a3815.js"><link rel="prefetch" href="/assets/js/103.b27b845c.js"><link rel="prefetch" href="/assets/js/104.66db0c7a.js"><link rel="prefetch" href="/assets/js/105.900b60f5.js"><link rel="prefetch" href="/assets/js/107.29f88d5b.js"><link rel="prefetch" href="/assets/js/108.7981e08e.js"><link rel="prefetch" href="/assets/js/109.b33024ae.js"><link rel="prefetch" href="/assets/js/11.8bb20b07.js"><link rel="prefetch" href="/assets/js/110.3b0e64b4.js"><link rel="prefetch" href="/assets/js/111.8906ec31.js"><link rel="prefetch" href="/assets/js/112.f2c7dd3a.js"><link rel="prefetch" href="/assets/js/113.4126790c.js"><link rel="prefetch" href="/assets/js/114.f584a619.js"><link rel="prefetch" href="/assets/js/115.aa3ce001.js"><link rel="prefetch" href="/assets/js/116.9fc7b46a.js"><link rel="prefetch" href="/assets/js/117.02392f6b.js"><link rel="prefetch" href="/assets/js/118.be950d41.js"><link rel="prefetch" href="/assets/js/119.12f1724b.js"><link rel="prefetch" href="/assets/js/12.495dead6.js"><link rel="prefetch" href="/assets/js/120.8ec47d18.js"><link rel="prefetch" href="/assets/js/121.59dab4d9.js"><link rel="prefetch" href="/assets/js/122.ba73929a.js"><link rel="prefetch" href="/assets/js/123.f1f96cdb.js"><link rel="prefetch" href="/assets/js/124.e9ee3ab6.js"><link rel="prefetch" href="/assets/js/13.125ff0e3.js"><link rel="prefetch" href="/assets/js/14.638fd70a.js"><link rel="prefetch" href="/assets/js/15.c6414c00.js"><link rel="prefetch" href="/assets/js/16.e5534201.js"><link rel="prefetch" href="/assets/js/17.52920d84.js"><link rel="prefetch" href="/assets/js/18.e348c11a.js"><link rel="prefetch" href="/assets/js/19.3b4ed4a3.js"><link rel="prefetch" href="/assets/js/20.91aa8274.js"><link rel="prefetch" href="/assets/js/21.ef7544cb.js"><link rel="prefetch" href="/assets/js/22.c79ecf29.js"><link rel="prefetch" href="/assets/js/23.d74b8bc0.js"><link rel="prefetch" href="/assets/js/24.e1b7042f.js"><link rel="prefetch" href="/assets/js/25.ee0d54de.js"><link rel="prefetch" href="/assets/js/26.5ce41a17.js"><link rel="prefetch" href="/assets/js/27.506fca63.js"><link rel="prefetch" href="/assets/js/28.9e16b1bc.js"><link rel="prefetch" href="/assets/js/29.5f3fc6bd.js"><link rel="prefetch" href="/assets/js/3.56a9ad25.js"><link rel="prefetch" href="/assets/js/30.0b8b1b94.js"><link rel="prefetch" href="/assets/js/31.f972863c.js"><link rel="prefetch" href="/assets/js/32.58c91d73.js"><link rel="prefetch" href="/assets/js/33.40ec3e53.js"><link rel="prefetch" href="/assets/js/34.e948a627.js"><link rel="prefetch" href="/assets/js/35.89965b4f.js"><link rel="prefetch" href="/assets/js/36.773346af.js"><link rel="prefetch" href="/assets/js/37.8265a7ea.js"><link rel="prefetch" href="/assets/js/38.6814416d.js"><link rel="prefetch" href="/assets/js/39.2b4fe455.js"><link rel="prefetch" href="/assets/js/4.b41e69dd.js"><link rel="prefetch" href="/assets/js/40.fda79697.js"><link rel="prefetch" href="/assets/js/41.868f73f6.js"><link rel="prefetch" href="/assets/js/42.252a1ee9.js"><link rel="prefetch" href="/assets/js/43.4776516f.js"><link rel="prefetch" href="/assets/js/44.46eab99f.js"><link rel="prefetch" href="/assets/js/45.30564ad8.js"><link rel="prefetch" href="/assets/js/46.f0ad47dd.js"><link rel="prefetch" href="/assets/js/47.1b687bd7.js"><link rel="prefetch" href="/assets/js/48.16105aba.js"><link rel="prefetch" href="/assets/js/49.4c2c2c5e.js"><link rel="prefetch" href="/assets/js/5.5bc5eaa4.js"><link rel="prefetch" href="/assets/js/50.76421ba3.js"><link rel="prefetch" href="/assets/js/51.2f7f6f8b.js"><link rel="prefetch" href="/assets/js/52.4d4ee877.js"><link rel="prefetch" href="/assets/js/53.3c3a975c.js"><link rel="prefetch" href="/assets/js/54.4c9798c7.js"><link rel="prefetch" href="/assets/js/55.46fb092c.js"><link rel="prefetch" href="/assets/js/56.cc9a5bea.js"><link rel="prefetch" href="/assets/js/57.2dfac948.js"><link rel="prefetch" href="/assets/js/58.a1f91605.js"><link rel="prefetch" href="/assets/js/59.dbfdef0b.js"><link rel="prefetch" href="/assets/js/6.e416f727.js"><link rel="prefetch" href="/assets/js/60.a91a795c.js"><link rel="prefetch" href="/assets/js/61.bc1f5260.js"><link rel="prefetch" href="/assets/js/62.e2ccf952.js"><link rel="prefetch" href="/assets/js/63.2bd0c4cc.js"><link rel="prefetch" href="/assets/js/64.62c29a64.js"><link rel="prefetch" href="/assets/js/65.c110ae95.js"><link rel="prefetch" href="/assets/js/66.8e1a481f.js"><link rel="prefetch" href="/assets/js/67.30980d54.js"><link rel="prefetch" href="/assets/js/68.ba51dd58.js"><link rel="prefetch" href="/assets/js/69.336ac10e.js"><link rel="prefetch" href="/assets/js/7.671bf4d5.js"><link rel="prefetch" href="/assets/js/70.1a2832a2.js"><link rel="prefetch" href="/assets/js/71.5225ac1d.js"><link rel="prefetch" href="/assets/js/72.dd642248.js"><link rel="prefetch" href="/assets/js/73.84d46fc4.js"><link rel="prefetch" href="/assets/js/74.e1e7d470.js"><link rel="prefetch" href="/assets/js/75.2d7155c4.js"><link rel="prefetch" href="/assets/js/76.1b9e602d.js"><link rel="prefetch" href="/assets/js/77.cb915066.js"><link rel="prefetch" href="/assets/js/78.9bfd5a4d.js"><link rel="prefetch" href="/assets/js/79.cea94be8.js"><link rel="prefetch" href="/assets/js/8.c1053140.js"><link rel="prefetch" href="/assets/js/80.dcf79b90.js"><link rel="prefetch" href="/assets/js/81.4bcdd175.js"><link rel="prefetch" href="/assets/js/82.a39c4dd4.js"><link rel="prefetch" href="/assets/js/83.d020fb52.js"><link rel="prefetch" href="/assets/js/84.b656b381.js"><link rel="prefetch" href="/assets/js/85.63f2aab3.js"><link rel="prefetch" href="/assets/js/86.f207c5aa.js"><link rel="prefetch" href="/assets/js/87.4ff13574.js"><link rel="prefetch" href="/assets/js/88.90318af9.js"><link rel="prefetch" href="/assets/js/89.c738a3bb.js"><link rel="prefetch" href="/assets/js/9.25317bd4.js"><link rel="prefetch" href="/assets/js/90.5cfedce5.js"><link rel="prefetch" href="/assets/js/91.65e09223.js"><link rel="prefetch" href="/assets/js/92.af40c683.js"><link rel="prefetch" href="/assets/js/93.3e34cd57.js"><link rel="prefetch" href="/assets/js/94.24583a56.js"><link rel="prefetch" href="/assets/js/95.f3157245.js"><link rel="prefetch" href="/assets/js/96.f12c7c46.js"><link rel="prefetch" href="/assets/js/97.83aad559.js"><link rel="prefetch" href="/assets/js/98.3e876f13.js"><link rel="prefetch" href="/assets/js/99.711d526d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a748b10c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/icon.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  ä¸»é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æŠ€æœ¯åˆ†äº«" class="dropdown-title"><span class="title">æŠ€æœ¯åˆ†äº«</span> <span class="arrow down"></span></button> <button type="button" aria-label="æŠ€æœ¯åˆ†äº«" class="mobile-dropdown-title"><span class="title">æŠ€æœ¯åˆ†äº«</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/javascript-learning-and-summary/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/html/html-learning-and-summary/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/css/css-learning-and-summary/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link router-link-active">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/react/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/webpack/webpack-learning-and-summary/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/ts/ts-learning-and-summary/" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/nodejs/nodejs-learning-and-summary/" class="nav-link">
  Nodejs
</a></li><li class="dropdown-item"><!----> <a href="/weex/weex-learning-and-summary/" class="nav-link">
  Weex
</a></li><li class="dropdown-item"><!----> <a href="/network/network-learning-and-summary/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/datastructure/datastructure-learning-and-summary/" class="nav-link">
  æ•°æ®ç»“æ„
</a></li><li class="dropdown-item"><!----> <a href="/mixin/mixin-learning-and-summary/" class="nav-link">
  æ—¥å¸¸æ‚è®°
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Andraw-lin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  ä¸»é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æŠ€æœ¯åˆ†äº«" class="dropdown-title"><span class="title">æŠ€æœ¯åˆ†äº«</span> <span class="arrow down"></span></button> <button type="button" aria-label="æŠ€æœ¯åˆ†äº«" class="mobile-dropdown-title"><span class="title">æŠ€æœ¯åˆ†äº«</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/javascript-learning-and-summary/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/html/html-learning-and-summary/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/css/css-learning-and-summary/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link router-link-active">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/react/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/webpack/webpack-learning-and-summary/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/ts/ts-learning-and-summary/" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/nodejs/nodejs-learning-and-summary/" class="nav-link">
  Nodejs
</a></li><li class="dropdown-item"><!----> <a href="/weex/weex-learning-and-summary/" class="nav-link">
  Weex
</a></li><li class="dropdown-item"><!----> <a href="/network/network-learning-and-summary/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/datastructure/datastructure-learning-and-summary/" class="nav-link">
  æ•°æ®ç»“æ„
</a></li><li class="dropdown-item"><!----> <a href="/mixin/mixin-learning-and-summary/" class="nav-link">
  æ—¥å¸¸æ‚è®°
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Andraw-lin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/vue/" aria-current="page" class="sidebar-link">Vue å­¦ä¹ å’Œæ€»ç»“</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/vue/vue3-changes/" class="sidebar-heading clickable"><span>vue3å€¼å¾—å…³æ³¨çš„å˜åŒ–</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vue/vue-source-explporation/" class="sidebar-heading clickable router-link-active open"><span>Vue v2.6.10æºç çš„æ¢ç©¶å’Œå­¦ä¹ </span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘æ•°æ®åˆå§‹åŒ–ä¹‹å“åº”å¼æ¢ç©¶ï¼ˆä¸Šï¼‰.html" class="sidebar-link">1. æ•°æ®åˆå§‹åŒ–ä¹‹å“åº”å¼æ¢ç©¶ï¼ˆä¸Šï¼‰</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘æ•°æ®åˆå§‹åŒ–ä¹‹å“åº”å¼æ¢ç©¶ï¼ˆä¸‹ï¼‰.html" class="sidebar-link">2. æ•°æ®åˆå§‹åŒ–ä¹‹å“åº”å¼æ¢ç©¶ï¼ˆä¸‹ï¼‰</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘æ•°æ®åˆå§‹åŒ–ä¹‹ä¾èµ–æ”¶é›†ï¼ˆä¸Šï¼‰.html" class="sidebar-link">3. æ•°æ®åˆå§‹åŒ–ä¹‹ä¾èµ–æ”¶é›†ï¼ˆä¸Šï¼‰</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘æ•°æ®åˆå§‹åŒ–ä¹‹ä¾èµ–æ”¶é›†ï¼ˆä¸‹ï¼‰.html" class="sidebar-link">4. æ•°æ®åˆå§‹åŒ–ä¹‹ä¾èµ–æ”¶é›†ï¼ˆä¸‹ï¼‰</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘æ•°æ®åˆå§‹åŒ–ä¹‹ä¾èµ–æ›´æ–°.html" class="sidebar-link">5. æ•°æ®åˆå§‹åŒ–ä¹‹ä¾èµ–æ›´æ–°</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨ $forceUpdate.html" class="sidebar-link">6. ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨ $forceUpdate</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘è®¡ç®—å±æ€§ Computed.html" class="sidebar-link">7. è®¡ç®—å±æ€§ Computed</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘ä¾¦å¬å™¨ Watch.html" class="sidebar-link">8. ä¾¦å¬å™¨ Watch</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘æ–¹æ³• Methods.html" class="sidebar-link">9. æ–¹æ³• Methods</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘è¿è¡Œæœºåˆ¶ä¹‹ Props.html" class="sidebar-link">10. è¿è¡Œæœºåˆ¶ä¹‹ Props</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘æ··åˆ Mixinï¼ˆä¸Šï¼‰.html" class="sidebar-link">11. æ··åˆ Mixinï¼ˆä¸Šï¼‰</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘æ··åˆ Mixinï¼ˆä¸‹ï¼‰.html" class="sidebar-link">12. æ··åˆ Mixinï¼ˆä¸‹ï¼‰</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘ç”Ÿå‘½å‘¨æœŸ Lifecycle.html" class="sidebar-link">13. ç”Ÿå‘½å‘¨æœŸ Lifecycle</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘å¼‚æ­¥æ›´æ–°é˜Ÿåˆ—ä¹‹ NextTick.html" class="sidebar-link">14. å¼‚æ­¥æ›´æ–°é˜Ÿåˆ—ä¹‹ NextTick</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘ä» Template åˆ° DOM è¿‡ç¨‹æ˜¯æ€æ ·çš„.html" class="sidebar-link">15. ä» Template åˆ° DOM è¿‡ç¨‹æ˜¯æ€æ ·çš„</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘ç¼–è¯‘ Compileï¼ˆä¸Šï¼‰.html" class="sidebar-link">16. ç¼–è¯‘ Compileï¼ˆä¸Šï¼‰</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘ç¼–è¯‘ Compileï¼ˆä¸‹ï¼‰.html" class="sidebar-link">17. ç¼–è¯‘ Compileï¼ˆä¸‹ï¼‰</a></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘æ¸²æŸ“ Render.html" class="active sidebar-link">18. æ¸²æŸ“ Render (AST -&gt; VNode)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘æ¸²æŸ“ Render.html#æ¸²æŸ“-render-åŠŸèƒ½" class="sidebar-link">æ¸²æŸ“ Render åŠŸèƒ½</a></li><li class="sidebar-sub-header"><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘æ¸²æŸ“ Render.html#ä»æºç è§’åº¦è¿›è¡Œåˆ†æ" class="sidebar-link">ä»æºç è§’åº¦è¿›è¡Œåˆ†æ</a></li></ul></li><li><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘å¦‚ä½•åœ¨æ›´æ–° Patch ä¸­è¿›è¡Œ Diff.html" class="sidebar-link">19. å¦‚ä½•åœ¨æ›´æ–° Patch ä¸­è¿›è¡Œ Diff</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="æ¸²æŸ“-render-åŠŸèƒ½"><a href="#æ¸²æŸ“-render-åŠŸèƒ½" class="header-anchor">#</a> æ¸²æŸ“ Render åŠŸèƒ½</h2> <p>åœ¨ä¸äº†è§£<code>Render</code>å®ç°æƒ…å†µä¸‹ï¼Œå¾ˆå®¹æ˜“ä¼šè®¤ä¸ºå®ƒçš„åŠŸèƒ½å°±æ˜¯ç›´æ¥å°†<code>AST</code>é€šè¿‡æ‰§è¡Œæ¸²æŸ“æ–¹æ³•ä»è€Œå¾—åˆ°çœŸå® DOMï¼ˆå½“åˆæˆ‘ä¹Ÿæ˜¯è¿™æ ·è®¤ä¸ºçš„ ğŸ˜…ï¼‰ã€‚</p> <p>æ—¢ç„¶<code>Render</code>ä¸å…·å¤‡ä¸Šè¿°çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆå®ƒçš„åŠŸèƒ½åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p> <p>çœ‹åˆ°æ ‡é¢˜ï¼Œä½ åº”è¯¥ä¹ŸçŸ¥é“äº†ç­”æ¡ˆï¼Œé‚£å°±æ˜¯<strong>å°†<code>AST</code>è½¬æ¢ä¸º<code>VNode</code>èŠ‚ç‚¹</strong>ã€‚é‚£ä¹ˆè½¬åŒ–ä¸ºçœŸå® DOM åˆæ˜¯å‘ç”Ÿåœ¨å“ªä¸ªæ­¥éª¤å‘¢ï¼Ÿä¸ç’ä½ è¯´ï¼Œé‚£å°±æ˜¯<strong>åœ¨æœ€åä¸€æ­¥<code>Diff</code>è¿‡ç¨‹æ‰€å¾—åˆ°ä¸¤ä¸ª<code>VNode</code>èŠ‚ç‚¹å·®å¼‚åï¼Œæ‰ä¼šå°†å·®å¼‚æ¸²æŸ“åˆ°çœŸå®ç¯å¢ƒä¸­å½¢æˆè§†å›¾</strong>ã€‚</p> <p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥ä»æºç è§’åº¦æ¢ç©¶ä¸€ä¸‹ï¼Œ<code>Render</code>æ˜¯å¦‚ä½•å°†<code>AST</code>è½¬æ¢ä¸º<code>VNode</code>çš„ã€‚ğŸ˜¼</p> <h2 id="ä»æºç è§’åº¦è¿›è¡Œåˆ†æ"><a href="#ä»æºç è§’åº¦è¿›è¡Œåˆ†æ" class="header-anchor">#</a> ä»æºç è§’åº¦è¿›è¡Œåˆ†æ</h2> <p>ç›¸ä¿¡çœ‹è¿‡<a href="https://github.com/Andraw-lin/about-Vue/blob/master/docs/%E3%80%90%20Vue%20%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%20%E3%80%91%E4%BB%8E%20Template%20%E5%88%B0%20DOM%20%E8%BF%87%E7%A8%8B%E6%98%AF%E6%80%8E%E6%A0%B7%E7%9A%84.md" target="_blank" rel="noopener noreferrer">ã€ä» Template åˆ° DOM è¿‡ç¨‹æ˜¯æ€æ ·çš„ã€‘<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>çš„è¯ï¼Œéƒ½åº”è¯¥æ¯”è¾ƒæ¸…æ¥šã€‚å†ç¼–è¯‘<code>compile</code>åï¼Œå°±ä¼šç›´æ¥è°ƒç”¨<code>$mount</code>æ–¹æ³•ï¼Œæˆ‘ä»¬å†æ¥ç®€å•å›é¡¾ä¸€ä¸‹ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$mount</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>
 <span class="token parameter">el<span class="token punctuation">,</span>
 hydrating</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  el <span class="token operator">=</span> el <span class="token operator">&amp;&amp;</span> inBrowser <span class="token operator">?</span> <span class="token function">query</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">mountComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> el<span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span> <span class="token comment">// åŠ è½½å…ƒç´ æˆ–ç»„ä»¶æ–¹æ³•</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> mount <span class="token operator">=</span> <span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$mount
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$mount</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>
 <span class="token parameter">el<span class="token punctuation">,</span>
 hydrating</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">var</span> ref <span class="token operator">=</span> <span class="token function">compileToFunctions</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">// ç»è¿‡ç¼–è¯‘Compileåå¾—åˆ°æœ€ç»ˆæ¸²æŸ“æ–¹æ³•ç›¸å…³å¯¹è±¡</span>
    outputSourceRange<span class="token operator">:</span> <span class="token string">&quot;development&quot;</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
    shouldDecodeNewlines<span class="token operator">:</span> shouldDecodeNewlines<span class="token punctuation">,</span>
    shouldDecodeNewlinesForHref<span class="token operator">:</span> shouldDecodeNewlinesForHref<span class="token punctuation">,</span>
    delimiters<span class="token operator">:</span> options<span class="token punctuation">.</span>delimiters<span class="token punctuation">,</span>
    comments<span class="token operator">:</span> options<span class="token punctuation">.</span>comments
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> render <span class="token operator">=</span> ref<span class="token punctuation">.</span>render<span class="token punctuation">;</span>
  <span class="token keyword">var</span> staticRenderFns <span class="token operator">=</span> ref<span class="token punctuation">.</span>staticRenderFns<span class="token punctuation">;</span>
  options<span class="token punctuation">.</span>render <span class="token operator">=</span> render<span class="token punctuation">;</span> <span class="token comment">// å°†æ¸²æŸ“æ–¹æ³•æŒ‚è½½åˆ°å®ä¾‹é€‰é¡¹ä¸­</span>
  options<span class="token punctuation">.</span>staticRenderFns <span class="token operator">=</span> staticRenderFns<span class="token punctuation">;</span> <span class="token comment">// å°†æ”¶é›†åˆ°çš„é™æ€æ ‘æŒ‚è½½åˆ°é€‰é¡¹ä¸­</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">return</span> <span class="token function">mount</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> el<span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span> <span class="token comment">// æ­£å¼å¼€å§‹åŠ è½½å…ƒç´ </span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä»æµç¨‹ä¸Šå¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ç¼–è¯‘<code>Compile</code>åï¼Œå°±ä¼šå°†ç›¸åº”çš„æ¸²æŸ“æ–¹æ³•ä»¥åŠæ”¶é›†åˆ°çš„é™æ€æ ‘ç»Ÿä¸€æŒ‚è½½åˆ°é€‰é¡¹ä¿¡æ¯ä¸­ï¼Œæ¥ç€æ­£å¼å¼€å§‹åŠ è½½å…ƒç´ ã€‚</p> <p>åœ¨åŠ è½½å…ƒç´ é‡Œï¼Œæœ€ä¸»è¦å°±æ˜¯<code>mountComponent</code>æ–¹æ³•ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹æ˜¯å¦‚ä½•åŠ è½½çš„ ğŸ¤”ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">createEmptyVNode</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// åˆ›å»ºç©ºVNodeèŠ‚ç‚¹æ–¹æ³•</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> text <span class="token operator">===</span> <span class="token keyword">void</span> <span class="token number">0</span> <span class="token punctuation">)</span> text <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  node<span class="token punctuation">.</span>text <span class="token operator">=</span> text<span class="token punctuation">;</span>
  node<span class="token punctuation">.</span>isComment <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> node
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mountComponent</span> <span class="token punctuation">(</span>
 <span class="token parameter">vm<span class="token punctuation">,</span>
 el<span class="token punctuation">,</span>
 hydrating</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   vm<span class="token punctuation">.</span>$el <span class="token operator">=</span> el
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>render<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// è‹¥ä¸å­˜åœ¨æ¸²æŸ“æ–¹æ³•ï¼Œåˆ™ä½œä¸ºä¸€ä¸ªåˆ›å»ºç©ºVNodeèŠ‚ç‚¹æ¥å¤„ç†</span>
     vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>render <span class="token operator">=</span> createEmptyVNode<span class="token punctuation">;</span>
     <span class="token comment">// ...</span>
   <span class="token punctuation">}</span>
   <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'beforeMount'</span><span class="token punctuation">)</span> <span class="token comment">// å¼€å§‹æ‰§è¡ŒbeforeMountç”Ÿå‘½å‘¨æœŸå›è°ƒ</span>
   <span class="token keyword">var</span> updateComponent <span class="token comment">// è½¬åŒ–ASTä¸ºVNodeèŠ‚ç‚¹å¤–å±‚æ–¹æ³•</span>
   <span class="token comment">// ...</span>
   <span class="token function-variable function">updateComponent</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// ...</span>
     <span class="token keyword">var</span> vnode <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">_render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// æœ€ä¸»è¦çš„ï¼ï¼ï¼ç›´æ¥è½¬åŒ–ASTä¸ºVNodeèŠ‚ç‚¹</span>
     <span class="token comment">// ...</span>
     vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span> <span class="token comment">// å°†è½¬æ¢å¥½çš„VNodeæ”¾åˆ°æ›´æ–°å‡½æ•°ä¸­ä½¿ç”¨patchè¿›è¡Œæ¯”å¯¹</span>
     <span class="token comment">// ...</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> updateComponent<span class="token punctuation">,</span> noop<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">// åˆ›å»ºæ¨¡æ¿ä¾èµ–Watcherï¼Œå…¶ä¸­çš„æ›´æ–°å‡½æ•°å³ä¸ºupdateComponent</span>
     <span class="token function-variable function">before</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">before</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>_isMounted <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>vm<span class="token punctuation">.</span>_isDestroyed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'beforeUpdate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span> <span class="token comment">/* isRenderWatcher */</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
</code></pre></div><p><code>mountComponent</code>æ–¹æ³•ä¼šå…ˆåˆ¤æ–­å®ä¾‹é€‰é¡¹æ˜¯å¦æœ‰æ¸²æŸ“æ–¹æ³•ï¼Œè‹¥æ— åˆ™ç›´æ¥èµ‹å€¼ä¸ºç©ºVNodeèŠ‚ç‚¹ã€‚æ¥ç€ä½¿ç”¨å˜é‡<code>updateComponent</code>ä½œä¸ºæš´éœ²è½¬åŒ–<code>AST</code>ä¸º<code>VNode</code>å¤–å±‚æ–¹æ³•ï¼Œå¹¶åœ¨åˆ›å»ºæ¨¡æ¿ä¾èµ–æ—¶å°†å…¶ä½œä¸ºæ›´æ–°å›è°ƒå‡½æ•°ï¼Œè¿™æ ·ä¸€æ¥ï¼Œåœ¨æ¯æ¬¡æ›´æ–°æ—¶ï¼Œéƒ½ä¼šä½¿ç”¨<code>updateComponent</code>æ–¹æ³•æ‰§è¡Œè½¬åŒ–<code>AST</code>ä¸º<code>VNode</code>èŠ‚ç‚¹ã€‚</p> <p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå…¶ä¸­<code>_render</code>æ–¹æ³•æ˜¯è½¬åŒ–<code>AST</code>ä¸º<code>VNode</code>æ ¸å¿ƒæ–¹æ³•ï¼Œè€Œå¦ä¸€ä¸ª<code>_update</code>æ–¹æ³•åˆ™æ˜¯æœ€åç”¨äº<code>patch</code>æ¯”å¯¹ç”¨åˆ°çš„ï¼ˆ<code>_update</code>æ–¹æ³•æš‚æ—¶ä¸è®²ï¼Œä¼šåœ¨ä¸‹ä¸€ç« <code>Diff</code>è¯´æ³•ä¸­æåŠï¼‰ã€‚ç°åœ¨å°±æ¥ç»§ç»­çœ‹çœ‹<code>_render</code>æ–¹æ³•æ˜¯å¦‚ä½•å°†<code>AST</code>è½¬åŒ–ä¸º<code>VNode</code>èŠ‚ç‚¹çš„ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">_render</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> ref <span class="token operator">=</span> vm<span class="token punctuation">.</span>$options<span class="token punctuation">;</span>
  <span class="token keyword">var</span> render <span class="token operator">=</span> ref<span class="token punctuation">.</span>render<span class="token punctuation">;</span> <span class="token comment">// è·å–å®ä¾‹é€‰é¡¹ä¸­ä¿å­˜çš„æ¸²æŸ“æ–¹æ³•</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">var</span> vnode<span class="token punctuation">;</span> <span class="token comment">// VNodeèŠ‚ç‚¹å˜é‡</span>
  <span class="token comment">// ...</span>
  vnode <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>_renderProxy<span class="token punctuation">,</span> vm<span class="token punctuation">.</span>$createElement<span class="token punctuation">)</span> <span class="token comment">// æ ¹æ®æ¸²æŸ“æ–¹æ³•æ‰§è¡Œç›¸åº”çš„_c</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">return</span> vnode
<span class="token punctuation">}</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œç›´æ¥è°ƒç”¨äº†ç¼–è¯‘<code>Compile</code>å‡ºæ¥çš„æ¸²æŸ“æ–¹æ³•ã€‚</p> <p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹æ¸²æŸ“æ–¹æ³•æ˜¯å’‹æ ·çš„ï¼Ÿçœ‹çœ‹ä¸‹é¢è¿™ä¸ªæ —å­å‘€ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>Hello Word<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
<span class="token comment">// æ¸²æŸ“æ–¹æ³•å¦‚ä¸‹</span>
<span class="token keyword">with</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">'Hello Word...'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç»ˆç©¶å›åˆ°äº†ä¸Šä¸€ç« ä¸­ç•™ä¸‹æ¥çš„é—®é¢˜ï¼Œç©¶ç«Ÿ<code>_c</code>å’Œ<code>_v</code>æ˜¯å¹²å˜›ç”¨çš„ï¼ŸğŸ¤”</p> <p>å…¶å®å®ƒä»¬éƒ½æ˜¯å°¤å¤§å¤§åœ¨å†…éƒ¨å°è£…å¥½çš„å„ç§æ¸²æŸ“æ–¹æ³•ï¼Œä¸å¦¨æˆ‘ä»¬å°±æ¥çœ‹çœ‹è¿˜æœ‰å“ªäº›ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">installRenderHelpers</span> <span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// é’ˆå¯¹å„ç§åœºæ™¯å°è£…å¥½çš„æ¸²æŸ“æ–¹æ³•</span>
  target<span class="token punctuation">.</span>_o <span class="token operator">=</span> markOnce<span class="token punctuation">;</span> <span class="token comment">// å¤„ç†v-onceæŒ‡ä»¤çš„æ¸²æŸ“æ–¹æ³•</span>
  target<span class="token punctuation">.</span>_n <span class="token operator">=</span> toNumber<span class="token punctuation">;</span> <span class="token comment">// å°†è¾“å…¥å€¼è½¬åŒ–ä¸ºæ•°å€¼ï¼Œè‹¥è½¬åŒ–å¤±è´¥åˆ™ç›´æ¥ä½¿ç”¨åŸå§‹å­—ç¬¦ä¸²</span>
  target<span class="token punctuation">.</span>_s <span class="token operator">=</span> toString<span class="token punctuation">;</span> <span class="token comment">// å°†è¾“å…¥å€¼è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</span>
  target<span class="token punctuation">.</span>_l <span class="token operator">=</span> renderList<span class="token punctuation">;</span> <span class="token comment">// å¤„ç†v-foræŒ‡ä»¤çš„æ¸²æŸ“æ–¹æ³•</span>
  target<span class="token punctuation">.</span>_t <span class="token operator">=</span> renderSlot<span class="token punctuation">;</span> <span class="token comment">// å¤„ç†v-slotæŒ‡ä»¤çš„æ¸²æŸ“æ–¹æ³•</span>
  target<span class="token punctuation">.</span>_q <span class="token operator">=</span> looseEqual<span class="token punctuation">;</span> <span class="token comment">// åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰</span>
  target<span class="token punctuation">.</span>_i <span class="token operator">=</span> looseIndexOf<span class="token punctuation">;</span> <span class="token comment">// åˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨ä¸è¾“å…¥å€¼ç›¸ç­‰çš„é¡¹</span>
  target<span class="token punctuation">.</span>_m <span class="token operator">=</span> renderStatic<span class="token punctuation">;</span> <span class="token comment">// å¤„ç†é™æ€æ ‘çš„æ¸²æŸ“æ–¹æ³•</span>
  target<span class="token punctuation">.</span>_f <span class="token operator">=</span> resolveFilter<span class="token punctuation">;</span> <span class="token comment">// å¤„ç†é€‰é¡¹ä¿¡æ¯ä¸­filtersé¡¹</span>
  target<span class="token punctuation">.</span>_k <span class="token operator">=</span> checkKeyCodes<span class="token punctuation">;</span> <span class="token comment">// åˆ¤æ–­é…ç½®ä¸­æ˜¯å¦æ‹¥æœ‰ç›¸åº”çš„eventKeyCode</span>
  target<span class="token punctuation">.</span>_b <span class="token operator">=</span> bindObjectProps<span class="token punctuation">;</span> <span class="token comment">// å°†v-bindæŒ‡ä»¤ç»‘å®šåˆ°ç›¸åº”çš„VNode</span>
  target<span class="token punctuation">.</span>_v <span class="token operator">=</span> createTextVNode<span class="token punctuation">;</span> <span class="token comment">// å¤„ç†æ–‡æœ¬èŠ‚ç‚¹çš„æ¸²æŸ“æ–¹æ³•</span>
  target<span class="token punctuation">.</span>_e <span class="token operator">=</span> createEmptyVNode<span class="token punctuation">;</span> <span class="token comment">// åˆ›å»ºç©ºèŠ‚ç‚¹çš„æ¸²æŸ“æ–¹æ³•</span>
  target<span class="token punctuation">.</span>_u <span class="token operator">=</span> resolveScopedSlots<span class="token punctuation">;</span> <span class="token comment">// å¤„ç†ScopedSlots</span>
  target<span class="token punctuation">.</span>_g <span class="token operator">=</span> bindObjectListeners<span class="token punctuation">;</span> <span class="token comment">// å¤„ç†å¯¹è±¡ç›‘å¬</span>
  target<span class="token punctuation">.</span>_d <span class="token operator">=</span> bindDynamicKeys<span class="token punctuation">;</span> <span class="token comment">// å¤„ç†v-bind:keyæ¸²æŸ“æ–¹æ³•</span>
  target<span class="token punctuation">.</span>_p <span class="token operator">=</span> prependModifier<span class="token punctuation">;</span> <span class="token comment">// åˆ¤æ–­ç±»å‹æ˜¯å¦ä¸ºå”¯ä¸€å­—ç¬¦ä¸²</span>
<span class="token punctuation">}</span>

vm<span class="token punctuation">.</span><span class="token function-variable function">_c</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">createElement</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token comment">// åˆ›å»ºå…ƒç´ VNodeèŠ‚ç‚¹</span>
</code></pre></div><p>ä¸Šè¿°ä»£ç ï¼Œå¯ä»¥å¾ˆä»”ç»†åœ°å±•ç¤ºäº†æ¯ä¸€ç§åœºæ™¯çš„å¤„ç†æ–¹æ¡ˆã€‚ç”±äºæ—¶é—´æœ‰é™ï¼Œæˆ‘å°±ä¸ä¼šå°†æ¯ä¸ªåœºæ™¯çš„å¤„ç†æºç éƒ½æå‡ºæ¥è®²ï¼Œåé¢æœ‰æ—¶é—´ä¼šå›æ¥å†è¿›è¡Œç›¸åº”çš„è®²è§£ã€‚</p> <p>ç›®å‰ä¹Ÿå¤§æ¦‚çŸ¥é“æ¯ä¸€ä¸ªå°è£…çš„æ¸²æŸ“æ–¹æ³•çš„å«ä¹‰ï¼Œå›åˆ°ä¸Šé¢çš„ä¸»é¢˜ï¼Œè°ƒç”¨ç¼–è¯‘<code>Compile</code>å‡ºæ¥çš„æ¸²æŸ“æ–¹æ³•ï¼Œï¼Œå…¶å®å°±æ˜¯è°ƒç”¨<code>_c</code>åˆ›å»ºå…ƒç´ <code>VNode</code>èŠ‚ç‚¹ã€‚</p> <p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹<code>_c</code>å†…éƒ¨æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">createElement</span> <span class="token punctuation">(</span>
 <span class="token parameter">context<span class="token punctuation">,</span>
 tag<span class="token punctuation">,</span>
 data<span class="token punctuation">,</span>
 children<span class="token punctuation">,</span>
 normalizationType<span class="token punctuation">,</span>
 alwaysNormalize</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isPrimitive</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// åˆ¤æ–­æ•°æ®æ˜¯å¦ä¸ºæ•°ç»„æˆ–åŸå§‹æ•°æ®ç±»å‹</span>
     normalizationType <span class="token operator">=</span> children<span class="token punctuation">;</span>
     children <span class="token operator">=</span> data<span class="token punctuation">;</span>
     data <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token comment">// ...</span>
   <span class="token keyword">return</span> <span class="token function">_createElement</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> tag<span class="token punctuation">,</span> data<span class="token punctuation">,</span> children<span class="token punctuation">,</span> normalizationType<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">_createElement</span> <span class="token punctuation">(</span>
 <span class="token parameter">context<span class="token punctuation">,</span>
 tag<span class="token punctuation">,</span>
 data<span class="token punctuation">,</span>
 children<span class="token punctuation">,</span>
 normalizationType</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isDef</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>__ob__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// åˆ¤æ–­æ•°æ®ä¸ä¸ºç©ºå¹¶ä¸”æ— ä¾èµ–æ—¶ï¼Œåˆ™ä½œä¸ºä¸€ä¸ªç©ºVNodeèŠ‚ç‚¹è¿›è¡Œå¤„ç†</span>
     <span class="token function">warn</span><span class="token punctuation">(</span>
        <span class="token string">&quot;Avoid using observed data object as vnode data: &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span> <span class="token operator">+</span>
        <span class="token string">'Always create fresh vnode data objects in each render!'</span><span class="token punctuation">,</span>
        context
      <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é¿å…ä½¿ç”¨éå“åº”å¼æ•°æ®åˆ›å»ºVNodeèŠ‚ç‚¹ï¼Œä¸ç„¶å¯¼è‡´æ¯æ¬¡æ¸²æŸ“éƒ½åŒ…å«å…¶ä¸­</span>
      <span class="token keyword">return</span> <span class="token function">createEmptyVNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// è¿”å›åˆ›å»ºçš„ç©ºVNodeèŠ‚ç‚¹</span>
   <span class="token punctuation">}</span>
   <span class="token comment">// ...</span>
   <span class="token keyword">var</span> vnode
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> tag <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// ...</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span><span class="token function">isReservedTag</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// åˆ¤æ–­æ ‡ç­¾åæ˜¯å¦ä¸ºHTMLæ ‡ç­¾</span>
       vnode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VNode</span><span class="token punctuation">(</span> <span class="token comment">// åˆ›å»ºå…ƒç´ VNodeèŠ‚ç‚¹</span>
         config<span class="token punctuation">.</span><span class="token function">parsePlatformTagName</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> children<span class="token punctuation">,</span>
         <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> context
       <span class="token punctuation">)</span>
     <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span>data <span class="token operator">||</span> <span class="token operator">!</span>data<span class="token punctuation">.</span>pre<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isDef</span><span class="token punctuation">(</span>Ctor <span class="token operator">=</span> <span class="token function">resolveAsset</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>$options<span class="token punctuation">,</span> <span class="token string">'components'</span><span class="token punctuation">,</span> tag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// åˆ¤æ–­æ˜¯å¦ä¸ºç»„ä»¶</span>
       vnode <span class="token operator">=</span> <span class="token function">createComponent</span><span class="token punctuation">(</span>Ctor<span class="token punctuation">,</span> data<span class="token punctuation">,</span> context<span class="token punctuation">,</span> children<span class="token punctuation">,</span> tag<span class="token punctuation">)</span> <span class="token comment">// åˆ›å»ºç»„ä»¶VNodeèŠ‚ç‚¹</span>
     <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// å…¶ä»–ä¸€å¾‹å½“æœªçŸ¥ç±»å‹åˆ›å»ºVNodeèŠ‚ç‚¹</span>
       vnode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VNode</span><span class="token punctuation">(</span>
         tag<span class="token punctuation">,</span> data<span class="token punctuation">,</span> children<span class="token punctuation">,</span>
         <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> context
       <span class="token punctuation">)</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// è‹¥æ ‡ç­¾åä¸æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ä½œä¸ºç»„ä»¶é€‰é¡¹/æ„é€ å‡½æ•°åˆ›å»ºç»„ä»¶</span>
     vnode <span class="token operator">=</span> <span class="token function">createComponent</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> data<span class="token punctuation">,</span> context<span class="token punctuation">,</span> children<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// åˆ¤æ–­ç”Ÿæˆçš„vnodeæ˜¯å¦ä¸ºæ•°ç»„ç±»å‹</span>
     <span class="token keyword">return</span> vnode
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// åˆ¤æ–­vnodeæ˜¯å¦ä¸ºç©º</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">applyNS</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> ns<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment">// å®šä¹‰å½“å‰èŠ‚ç‚¹çš„å‘½åç©ºé—´</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">registerDeepBindings</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment">// ç»‘å®šåŠ¨æ€çš„styleã€class</span>
     <span class="token keyword">return</span> vnode
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// è‹¥ä¸ºç©ºï¼Œåˆ™ç›´æ¥è¿”å›ä¸€ä¸ªç©ºVNodeèŠ‚ç‚¹</span>
     <span class="token keyword">return</span> <span class="token function">createEmptyVNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ‰§è¡Œæ¸²æŸ“æ–¹æ³•<code>_c</code>æ—¶ï¼Œæœ€ç»ˆéƒ½æ˜¯è¿”å›äº†åˆ›å»ºå¥½çš„<code>VNode</code>èŠ‚ç‚¹ã€‚</p> <p>ä»£ç ä¸Šå¯èƒ½è¿˜æœ‰äº›æ–¹æ³•æ²¡æœ‰ç»†è®²ï¼Œå¦‚<code>createComponent</code>ï¼Œå…¶å®åº•å±‚éƒ½æ˜¯ç»è¿‡ä¸€ç³»åˆ—çš„å¤„ç†åå¾—åˆ°ç›¸åº”çš„<code>VNode</code>èŠ‚ç‚¹ã€‚å¦å¤–ï¼Œæˆ‘ä¸ªäººè®¤ä¸ºåˆ›å»ºå¥½çš„<code>VNode</code>èŠ‚ç‚¹ç»ˆç©¶å°±æ˜¯ä¸€ä¸ªå¯¹è±¡å½¢å¼ï¼Œä¸ä¼šå­˜åœ¨æ•°ç»„å½¢å¼ï¼ˆè‹¥æœ‰é”™è¯¯ï¼Œå¸Œæœ›æŒ‡å‡ºå“ˆï¼‰ã€‚</p> <p>åˆ›å»ºå¥½çš„<code>VNode</code>èŠ‚ç‚¹æœ€ç»ˆç»è¿‡ç»‘å®šå½“å‰èŠ‚ç‚¹å‘½åç©ºé—´ä»¥åŠåŠ¨æ€çš„<code>style</code>ã€<code>class</code>ï¼Œæœ€ç»ˆå°†èŠ‚ç‚¹è¿”å›ã€‚</p> <p>æœ€åçš„æœ€åï¼Œæ¸²æŸ“<code>Render</code>æœ€ç»ˆå®ç°çš„åŠŸèƒ½å°±æ˜¯<strong>å°†è½¬åŒ–å¥½çš„<code>AST</code>æ¸²æŸ“æ–¹æ³•ï¼Œç›´æ¥é€šè¿‡<code>VNode</code>æ„é€ å‡½æ•°æ„å»ºç›¸åº”çš„<code>VNode</code>èŠ‚ç‚¹</strong>ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¼šå»ºç«‹ä¸€ä¸ªæ¨¡æ¿ä¾èµ– Watcherï¼Œå¹¶ä¸”å°†è½¬åŒ–è¿‡ç¨‹ä½œä¸ºä¸€ä¸ªæ›´æ–°å›è°ƒæ–¹æ³•ä¿å­˜ï¼Œ<strong>æ¯å½“å“åº”å¼æ•°æ®æ›´æ–°æ—¶ï¼Œéƒ½ä¼šè§¦å‘è¯¥è¿‡ç¨‹ï¼Œå…ˆæ¸²æŸ“å‡ºç›¸åº”çš„<code>VNode</code>èŠ‚ç‚¹ï¼Œå†è¿›è¡Œ<code>patch</code>æ¯”å¯¹ï¼Œæœ€åå°†æ¯”å¯¹çš„å·®å¼‚ç›´æ¥æ¸²æŸ“æˆç›¸åº”çš„çœŸå®<code>DOM</code></strong>ã€‚</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘ç¼–è¯‘ Compileï¼ˆä¸‹ï¼‰.html" class="prev">
        17. ç¼–è¯‘ Compileï¼ˆä¸‹ï¼‰
      </a></span> <span class="next"><a href="/vue/vue-source-explporation/ã€ Vue æºç åˆ†æ ã€‘å¦‚ä½•åœ¨æ›´æ–° Patch ä¸­è¿›è¡Œ Diff.html">
        19. å¦‚ä½•åœ¨æ›´æ–° Patch ä¸­è¿›è¡Œ Diff
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.62b9dc26.js" defer></script><script src="/assets/js/2.1177bb59.js" defer></script><script src="/assets/js/106.9ccab627.js" defer></script>
  </body>
</html>
