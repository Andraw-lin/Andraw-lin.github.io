<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>渲染 Render 功能</title>
    <meta name="generator" content="VuePress 1.6.0">
    
    <meta name="description" content="好好学习，天天向上💪">
    <link rel="preload" href="/assets/css/0.styles.a748b10c.css" as="style"><link rel="preload" href="/assets/js/app.62b9dc26.js" as="script"><link rel="preload" href="/assets/js/2.1177bb59.js" as="script"><link rel="preload" href="/assets/js/106.9ccab627.js" as="script"><link rel="prefetch" href="/assets/js/10.a3eb2dd7.js"><link rel="prefetch" href="/assets/js/100.a0587a90.js"><link rel="prefetch" href="/assets/js/101.bc61ee8e.js"><link rel="prefetch" href="/assets/js/102.6c9a3815.js"><link rel="prefetch" href="/assets/js/103.b27b845c.js"><link rel="prefetch" href="/assets/js/104.66db0c7a.js"><link rel="prefetch" href="/assets/js/105.900b60f5.js"><link rel="prefetch" href="/assets/js/107.29f88d5b.js"><link rel="prefetch" href="/assets/js/108.7981e08e.js"><link rel="prefetch" href="/assets/js/109.b33024ae.js"><link rel="prefetch" href="/assets/js/11.8bb20b07.js"><link rel="prefetch" href="/assets/js/110.3b0e64b4.js"><link rel="prefetch" href="/assets/js/111.8906ec31.js"><link rel="prefetch" href="/assets/js/112.f2c7dd3a.js"><link rel="prefetch" href="/assets/js/113.4126790c.js"><link rel="prefetch" href="/assets/js/114.f584a619.js"><link rel="prefetch" href="/assets/js/115.aa3ce001.js"><link rel="prefetch" href="/assets/js/116.9fc7b46a.js"><link rel="prefetch" href="/assets/js/117.02392f6b.js"><link rel="prefetch" href="/assets/js/118.be950d41.js"><link rel="prefetch" href="/assets/js/119.12f1724b.js"><link rel="prefetch" href="/assets/js/12.495dead6.js"><link rel="prefetch" href="/assets/js/120.8ec47d18.js"><link rel="prefetch" href="/assets/js/121.59dab4d9.js"><link rel="prefetch" href="/assets/js/122.ba73929a.js"><link rel="prefetch" href="/assets/js/123.f1f96cdb.js"><link rel="prefetch" href="/assets/js/124.e9ee3ab6.js"><link rel="prefetch" href="/assets/js/13.125ff0e3.js"><link rel="prefetch" href="/assets/js/14.638fd70a.js"><link rel="prefetch" href="/assets/js/15.c6414c00.js"><link rel="prefetch" href="/assets/js/16.e5534201.js"><link rel="prefetch" href="/assets/js/17.52920d84.js"><link rel="prefetch" href="/assets/js/18.e348c11a.js"><link rel="prefetch" href="/assets/js/19.3b4ed4a3.js"><link rel="prefetch" href="/assets/js/20.91aa8274.js"><link rel="prefetch" href="/assets/js/21.ef7544cb.js"><link rel="prefetch" href="/assets/js/22.c79ecf29.js"><link rel="prefetch" href="/assets/js/23.d74b8bc0.js"><link rel="prefetch" href="/assets/js/24.e1b7042f.js"><link rel="prefetch" href="/assets/js/25.ee0d54de.js"><link rel="prefetch" href="/assets/js/26.5ce41a17.js"><link rel="prefetch" href="/assets/js/27.506fca63.js"><link rel="prefetch" href="/assets/js/28.9e16b1bc.js"><link rel="prefetch" href="/assets/js/29.5f3fc6bd.js"><link rel="prefetch" href="/assets/js/3.56a9ad25.js"><link rel="prefetch" href="/assets/js/30.0b8b1b94.js"><link rel="prefetch" href="/assets/js/31.f972863c.js"><link rel="prefetch" href="/assets/js/32.58c91d73.js"><link rel="prefetch" href="/assets/js/33.40ec3e53.js"><link rel="prefetch" href="/assets/js/34.e948a627.js"><link rel="prefetch" href="/assets/js/35.89965b4f.js"><link rel="prefetch" href="/assets/js/36.773346af.js"><link rel="prefetch" href="/assets/js/37.8265a7ea.js"><link rel="prefetch" href="/assets/js/38.6814416d.js"><link rel="prefetch" href="/assets/js/39.2b4fe455.js"><link rel="prefetch" href="/assets/js/4.b41e69dd.js"><link rel="prefetch" href="/assets/js/40.fda79697.js"><link rel="prefetch" href="/assets/js/41.868f73f6.js"><link rel="prefetch" href="/assets/js/42.252a1ee9.js"><link rel="prefetch" href="/assets/js/43.4776516f.js"><link rel="prefetch" href="/assets/js/44.46eab99f.js"><link rel="prefetch" href="/assets/js/45.30564ad8.js"><link rel="prefetch" href="/assets/js/46.f0ad47dd.js"><link rel="prefetch" href="/assets/js/47.1b687bd7.js"><link rel="prefetch" href="/assets/js/48.16105aba.js"><link rel="prefetch" href="/assets/js/49.4c2c2c5e.js"><link rel="prefetch" href="/assets/js/5.5bc5eaa4.js"><link rel="prefetch" href="/assets/js/50.76421ba3.js"><link rel="prefetch" href="/assets/js/51.2f7f6f8b.js"><link rel="prefetch" href="/assets/js/52.4d4ee877.js"><link rel="prefetch" href="/assets/js/53.3c3a975c.js"><link rel="prefetch" href="/assets/js/54.4c9798c7.js"><link rel="prefetch" href="/assets/js/55.46fb092c.js"><link rel="prefetch" href="/assets/js/56.cc9a5bea.js"><link rel="prefetch" href="/assets/js/57.2dfac948.js"><link rel="prefetch" href="/assets/js/58.a1f91605.js"><link rel="prefetch" href="/assets/js/59.dbfdef0b.js"><link rel="prefetch" href="/assets/js/6.e416f727.js"><link rel="prefetch" href="/assets/js/60.a91a795c.js"><link rel="prefetch" href="/assets/js/61.bc1f5260.js"><link rel="prefetch" href="/assets/js/62.e2ccf952.js"><link rel="prefetch" href="/assets/js/63.2bd0c4cc.js"><link rel="prefetch" href="/assets/js/64.62c29a64.js"><link rel="prefetch" href="/assets/js/65.c110ae95.js"><link rel="prefetch" href="/assets/js/66.8e1a481f.js"><link rel="prefetch" href="/assets/js/67.30980d54.js"><link rel="prefetch" href="/assets/js/68.ba51dd58.js"><link rel="prefetch" href="/assets/js/69.336ac10e.js"><link rel="prefetch" href="/assets/js/7.671bf4d5.js"><link rel="prefetch" href="/assets/js/70.1a2832a2.js"><link rel="prefetch" href="/assets/js/71.5225ac1d.js"><link rel="prefetch" href="/assets/js/72.dd642248.js"><link rel="prefetch" href="/assets/js/73.84d46fc4.js"><link rel="prefetch" href="/assets/js/74.e1e7d470.js"><link rel="prefetch" href="/assets/js/75.2d7155c4.js"><link rel="prefetch" href="/assets/js/76.1b9e602d.js"><link rel="prefetch" href="/assets/js/77.cb915066.js"><link rel="prefetch" href="/assets/js/78.9bfd5a4d.js"><link rel="prefetch" href="/assets/js/79.cea94be8.js"><link rel="prefetch" href="/assets/js/8.c1053140.js"><link rel="prefetch" href="/assets/js/80.dcf79b90.js"><link rel="prefetch" href="/assets/js/81.4bcdd175.js"><link rel="prefetch" href="/assets/js/82.a39c4dd4.js"><link rel="prefetch" href="/assets/js/83.d020fb52.js"><link rel="prefetch" href="/assets/js/84.b656b381.js"><link rel="prefetch" href="/assets/js/85.63f2aab3.js"><link rel="prefetch" href="/assets/js/86.f207c5aa.js"><link rel="prefetch" href="/assets/js/87.4ff13574.js"><link rel="prefetch" href="/assets/js/88.90318af9.js"><link rel="prefetch" href="/assets/js/89.c738a3bb.js"><link rel="prefetch" href="/assets/js/9.25317bd4.js"><link rel="prefetch" href="/assets/js/90.5cfedce5.js"><link rel="prefetch" href="/assets/js/91.65e09223.js"><link rel="prefetch" href="/assets/js/92.af40c683.js"><link rel="prefetch" href="/assets/js/93.3e34cd57.js"><link rel="prefetch" href="/assets/js/94.24583a56.js"><link rel="prefetch" href="/assets/js/95.f3157245.js"><link rel="prefetch" href="/assets/js/96.f12c7c46.js"><link rel="prefetch" href="/assets/js/97.83aad559.js"><link rel="prefetch" href="/assets/js/98.3e876f13.js"><link rel="prefetch" href="/assets/js/99.711d526d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a748b10c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/icon.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术分享" class="dropdown-title"><span class="title">技术分享</span> <span class="arrow down"></span></button> <button type="button" aria-label="技术分享" class="mobile-dropdown-title"><span class="title">技术分享</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/javascript-learning-and-summary/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/html/html-learning-and-summary/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/css/css-learning-and-summary/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link router-link-active">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/react/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/webpack/webpack-learning-and-summary/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/ts/ts-learning-and-summary/" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/nodejs/nodejs-learning-and-summary/" class="nav-link">
  Nodejs
</a></li><li class="dropdown-item"><!----> <a href="/weex/weex-learning-and-summary/" class="nav-link">
  Weex
</a></li><li class="dropdown-item"><!----> <a href="/network/network-learning-and-summary/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/datastructure/datastructure-learning-and-summary/" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/mixin/mixin-learning-and-summary/" class="nav-link">
  日常杂记
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Andraw-lin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术分享" class="dropdown-title"><span class="title">技术分享</span> <span class="arrow down"></span></button> <button type="button" aria-label="技术分享" class="mobile-dropdown-title"><span class="title">技术分享</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/javascript-learning-and-summary/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/html/html-learning-and-summary/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/css/css-learning-and-summary/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link router-link-active">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/react/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/webpack/webpack-learning-and-summary/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/ts/ts-learning-and-summary/" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/nodejs/nodejs-learning-and-summary/" class="nav-link">
  Nodejs
</a></li><li class="dropdown-item"><!----> <a href="/weex/weex-learning-and-summary/" class="nav-link">
  Weex
</a></li><li class="dropdown-item"><!----> <a href="/network/network-learning-and-summary/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/datastructure/datastructure-learning-and-summary/" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/mixin/mixin-learning-and-summary/" class="nav-link">
  日常杂记
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Andraw-lin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/vue/" aria-current="page" class="sidebar-link">Vue 学习和总结</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/vue/vue3-changes/" class="sidebar-heading clickable"><span>vue3值得关注的变化</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vue/vue-source-explporation/" class="sidebar-heading clickable router-link-active open"><span>Vue v2.6.10源码的探究和学习</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】数据初始化之响应式探究（上）.html" class="sidebar-link">1. 数据初始化之响应式探究（上）</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】数据初始化之响应式探究（下）.html" class="sidebar-link">2. 数据初始化之响应式探究（下）</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】数据初始化之依赖收集（上）.html" class="sidebar-link">3. 数据初始化之依赖收集（上）</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】数据初始化之依赖收集（下）.html" class="sidebar-link">4. 数据初始化之依赖收集（下）</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】数据初始化之依赖更新.html" class="sidebar-link">5. 数据初始化之依赖更新</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】为什么不推荐使用 $forceUpdate.html" class="sidebar-link">6. 为什么不推荐使用 $forceUpdate</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】计算属性 Computed.html" class="sidebar-link">7. 计算属性 Computed</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】侦听器 Watch.html" class="sidebar-link">8. 侦听器 Watch</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】方法 Methods.html" class="sidebar-link">9. 方法 Methods</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】运行机制之 Props.html" class="sidebar-link">10. 运行机制之 Props</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】混合 Mixin（上）.html" class="sidebar-link">11. 混合 Mixin（上）</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】混合 Mixin（下）.html" class="sidebar-link">12. 混合 Mixin（下）</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】生命周期 Lifecycle.html" class="sidebar-link">13. 生命周期 Lifecycle</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】异步更新队列之 NextTick.html" class="sidebar-link">14. 异步更新队列之 NextTick</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】从 Template 到 DOM 过程是怎样的.html" class="sidebar-link">15. 从 Template 到 DOM 过程是怎样的</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】编译 Compile（上）.html" class="sidebar-link">16. 编译 Compile（上）</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】编译 Compile（下）.html" class="sidebar-link">17. 编译 Compile（下）</a></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】渲染 Render.html" class="active sidebar-link">18. 渲染 Render (AST -&gt; VNode)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/vue-source-explporation/【 Vue 源码分析 】渲染 Render.html#渲染-render-功能" class="sidebar-link">渲染 Render 功能</a></li><li class="sidebar-sub-header"><a href="/vue/vue-source-explporation/【 Vue 源码分析 】渲染 Render.html#从源码角度进行分析" class="sidebar-link">从源码角度进行分析</a></li></ul></li><li><a href="/vue/vue-source-explporation/【 Vue 源码分析 】如何在更新 Patch 中进行 Diff.html" class="sidebar-link">19. 如何在更新 Patch 中进行 Diff</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="渲染-render-功能"><a href="#渲染-render-功能" class="header-anchor">#</a> 渲染 Render 功能</h2> <p>在不了解<code>Render</code>实现情况下，很容易会认为它的功能就是直接将<code>AST</code>通过执行渲染方法从而得到真实 DOM（当初我也是这样认为的 😅）。</p> <p>既然<code>Render</code>不具备上述的功能，那么它的功能又是什么呢？</p> <p>看到标题，你应该也知道了答案，那就是<strong>将<code>AST</code>转换为<code>VNode</code>节点</strong>。那么转化为真实 DOM 又是发生在哪个步骤呢？不瞒你说，那就是<strong>在最后一步<code>Diff</code>过程所得到两个<code>VNode</code>节点差异后，才会将差异渲染到真实环境中形成视图</strong>。</p> <p>接下来，我们就来从源码角度探究一下，<code>Render</code>是如何将<code>AST</code>转换为<code>VNode</code>的。😼</p> <h2 id="从源码角度进行分析"><a href="#从源码角度进行分析" class="header-anchor">#</a> 从源码角度进行分析</h2> <p>相信看过<a href="https://github.com/Andraw-lin/about-Vue/blob/master/docs/%E3%80%90%20Vue%20%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%20%E3%80%91%E4%BB%8E%20Template%20%E5%88%B0%20DOM%20%E8%BF%87%E7%A8%8B%E6%98%AF%E6%80%8E%E6%A0%B7%E7%9A%84.md" target="_blank" rel="noopener noreferrer">【从 Template 到 DOM 过程是怎样的】<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的话，都应该比较清楚。再编译<code>compile</code>后，就会直接调用<code>$mount</code>方法，我们再来简单回顾一下。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$mount</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>
 <span class="token parameter">el<span class="token punctuation">,</span>
 hydrating</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  el <span class="token operator">=</span> el <span class="token operator">&amp;&amp;</span> inBrowser <span class="token operator">?</span> <span class="token function">query</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">mountComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> el<span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span> <span class="token comment">// 加载元素或组件方法</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> mount <span class="token operator">=</span> <span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$mount
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$mount</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>
 <span class="token parameter">el<span class="token punctuation">,</span>
 hydrating</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">var</span> ref <span class="token operator">=</span> <span class="token function">compileToFunctions</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">// 经过编译Compile后得到最终渲染方法相关对象</span>
    outputSourceRange<span class="token operator">:</span> <span class="token string">&quot;development&quot;</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
    shouldDecodeNewlines<span class="token operator">:</span> shouldDecodeNewlines<span class="token punctuation">,</span>
    shouldDecodeNewlinesForHref<span class="token operator">:</span> shouldDecodeNewlinesForHref<span class="token punctuation">,</span>
    delimiters<span class="token operator">:</span> options<span class="token punctuation">.</span>delimiters<span class="token punctuation">,</span>
    comments<span class="token operator">:</span> options<span class="token punctuation">.</span>comments
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> render <span class="token operator">=</span> ref<span class="token punctuation">.</span>render<span class="token punctuation">;</span>
  <span class="token keyword">var</span> staticRenderFns <span class="token operator">=</span> ref<span class="token punctuation">.</span>staticRenderFns<span class="token punctuation">;</span>
  options<span class="token punctuation">.</span>render <span class="token operator">=</span> render<span class="token punctuation">;</span> <span class="token comment">// 将渲染方法挂载到实例选项中</span>
  options<span class="token punctuation">.</span>staticRenderFns <span class="token operator">=</span> staticRenderFns<span class="token punctuation">;</span> <span class="token comment">// 将收集到的静态树挂载到选项中</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">return</span> <span class="token function">mount</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> el<span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span> <span class="token comment">// 正式开始加载元素</span>
<span class="token punctuation">}</span>
</code></pre></div><p>从流程上可以看到，通过编译<code>Compile</code>后，就会将相应的渲染方法以及收集到的静态树统一挂载到选项信息中，接着正式开始加载元素。</p> <p>在加载元素里，最主要就是<code>mountComponent</code>方法，我们再来看看是如何加载的 🤔。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">createEmptyVNode</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 创建空VNode节点方法</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> text <span class="token operator">===</span> <span class="token keyword">void</span> <span class="token number">0</span> <span class="token punctuation">)</span> text <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  node<span class="token punctuation">.</span>text <span class="token operator">=</span> text<span class="token punctuation">;</span>
  node<span class="token punctuation">.</span>isComment <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> node
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mountComponent</span> <span class="token punctuation">(</span>
 <span class="token parameter">vm<span class="token punctuation">,</span>
 el<span class="token punctuation">,</span>
 hydrating</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   vm<span class="token punctuation">.</span>$el <span class="token operator">=</span> el
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>render<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 若不存在渲染方法，则作为一个创建空VNode节点来处理</span>
     vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>render <span class="token operator">=</span> createEmptyVNode<span class="token punctuation">;</span>
     <span class="token comment">// ...</span>
   <span class="token punctuation">}</span>
   <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'beforeMount'</span><span class="token punctuation">)</span> <span class="token comment">// 开始执行beforeMount生命周期回调</span>
   <span class="token keyword">var</span> updateComponent <span class="token comment">// 转化AST为VNode节点外层方法</span>
   <span class="token comment">// ...</span>
   <span class="token function-variable function">updateComponent</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// ...</span>
     <span class="token keyword">var</span> vnode <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">_render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 最主要的！！！直接转化AST为VNode节点</span>
     <span class="token comment">// ...</span>
     vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span> <span class="token comment">// 将转换好的VNode放到更新函数中使用patch进行比对</span>
     <span class="token comment">// ...</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> updateComponent<span class="token punctuation">,</span> noop<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">// 创建模板依赖Watcher，其中的更新函数即为updateComponent</span>
     <span class="token function-variable function">before</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">before</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>_isMounted <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>vm<span class="token punctuation">.</span>_isDestroyed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'beforeUpdate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span> <span class="token comment">/* isRenderWatcher */</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
</code></pre></div><p><code>mountComponent</code>方法会先判断实例选项是否有渲染方法，若无则直接赋值为空VNode节点。接着使用变量<code>updateComponent</code>作为暴露转化<code>AST</code>为<code>VNode</code>外层方法，并在创建模板依赖时将其作为更新回调函数，这样一来，在每次更新时，都会使用<code>updateComponent</code>方法执行转化<code>AST</code>为<code>VNode</code>节点。</p> <p>在上述代码中，其中<code>_render</code>方法是转化<code>AST</code>为<code>VNode</code>核心方法，而另一个<code>_update</code>方法则是最后用于<code>patch</code>比对用到的（<code>_update</code>方法暂时不讲，会在下一章<code>Diff</code>说法中提及）。现在就来继续看看<code>_render</code>方法是如何将<code>AST</code>转化为<code>VNode</code>节点的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">_render</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> ref <span class="token operator">=</span> vm<span class="token punctuation">.</span>$options<span class="token punctuation">;</span>
  <span class="token keyword">var</span> render <span class="token operator">=</span> ref<span class="token punctuation">.</span>render<span class="token punctuation">;</span> <span class="token comment">// 获取实例选项中保存的渲染方法</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">var</span> vnode<span class="token punctuation">;</span> <span class="token comment">// VNode节点变量</span>
  <span class="token comment">// ...</span>
  vnode <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>_renderProxy<span class="token punctuation">,</span> vm<span class="token punctuation">.</span>$createElement<span class="token punctuation">)</span> <span class="token comment">// 根据渲染方法执行相应的_c</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">return</span> vnode
<span class="token punctuation">}</span>
</code></pre></div><p>可以看到，直接调用了编译<code>Compile</code>出来的渲染方法。</p> <p>首先，我们来回顾一下渲染方法是咋样的？看看下面这个栗子呀。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>Hello Word<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
<span class="token comment">// 渲染方法如下</span>
<span class="token keyword">with</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">'Hello Word...'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>终究回到了上一章中留下来的问题，究竟<code>_c</code>和<code>_v</code>是干嘛用的？🤔</p> <p>其实它们都是尤大大在内部封装好的各种渲染方法，不妨我们就来看看还有哪些。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">installRenderHelpers</span> <span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 针对各种场景封装好的渲染方法</span>
  target<span class="token punctuation">.</span>_o <span class="token operator">=</span> markOnce<span class="token punctuation">;</span> <span class="token comment">// 处理v-once指令的渲染方法</span>
  target<span class="token punctuation">.</span>_n <span class="token operator">=</span> toNumber<span class="token punctuation">;</span> <span class="token comment">// 将输入值转化为数值，若转化失败则直接使用原始字符串</span>
  target<span class="token punctuation">.</span>_s <span class="token operator">=</span> toString<span class="token punctuation">;</span> <span class="token comment">// 将输入值转化为字符串</span>
  target<span class="token punctuation">.</span>_l <span class="token operator">=</span> renderList<span class="token punctuation">;</span> <span class="token comment">// 处理v-for指令的渲染方法</span>
  target<span class="token punctuation">.</span>_t <span class="token operator">=</span> renderSlot<span class="token punctuation">;</span> <span class="token comment">// 处理v-slot指令的渲染方法</span>
  target<span class="token punctuation">.</span>_q <span class="token operator">=</span> looseEqual<span class="token punctuation">;</span> <span class="token comment">// 判断两个值是否相等</span>
  target<span class="token punctuation">.</span>_i <span class="token operator">=</span> looseIndexOf<span class="token punctuation">;</span> <span class="token comment">// 判断数组中是否存在与输入值相等的项</span>
  target<span class="token punctuation">.</span>_m <span class="token operator">=</span> renderStatic<span class="token punctuation">;</span> <span class="token comment">// 处理静态树的渲染方法</span>
  target<span class="token punctuation">.</span>_f <span class="token operator">=</span> resolveFilter<span class="token punctuation">;</span> <span class="token comment">// 处理选项信息中filters项</span>
  target<span class="token punctuation">.</span>_k <span class="token operator">=</span> checkKeyCodes<span class="token punctuation">;</span> <span class="token comment">// 判断配置中是否拥有相应的eventKeyCode</span>
  target<span class="token punctuation">.</span>_b <span class="token operator">=</span> bindObjectProps<span class="token punctuation">;</span> <span class="token comment">// 将v-bind指令绑定到相应的VNode</span>
  target<span class="token punctuation">.</span>_v <span class="token operator">=</span> createTextVNode<span class="token punctuation">;</span> <span class="token comment">// 处理文本节点的渲染方法</span>
  target<span class="token punctuation">.</span>_e <span class="token operator">=</span> createEmptyVNode<span class="token punctuation">;</span> <span class="token comment">// 创建空节点的渲染方法</span>
  target<span class="token punctuation">.</span>_u <span class="token operator">=</span> resolveScopedSlots<span class="token punctuation">;</span> <span class="token comment">// 处理ScopedSlots</span>
  target<span class="token punctuation">.</span>_g <span class="token operator">=</span> bindObjectListeners<span class="token punctuation">;</span> <span class="token comment">// 处理对象监听</span>
  target<span class="token punctuation">.</span>_d <span class="token operator">=</span> bindDynamicKeys<span class="token punctuation">;</span> <span class="token comment">// 处理v-bind:key渲染方法</span>
  target<span class="token punctuation">.</span>_p <span class="token operator">=</span> prependModifier<span class="token punctuation">;</span> <span class="token comment">// 判断类型是否为唯一字符串</span>
<span class="token punctuation">}</span>

vm<span class="token punctuation">.</span><span class="token function-variable function">_c</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">createElement</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token comment">// 创建元素VNode节点</span>
</code></pre></div><p>上述代码，可以很仔细地展示了每一种场景的处理方案。由于时间有限，我就不会将每个场景的处理源码都提出来讲，后面有时间会回来再进行相应的讲解。</p> <p>目前也大概知道每一个封装的渲染方法的含义，回到上面的主题，调用编译<code>Compile</code>出来的渲染方法，，其实就是调用<code>_c</code>创建元素<code>VNode</code>节点。</p> <p>接下来我们就来看看<code>_c</code>内部是如何实现的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">createElement</span> <span class="token punctuation">(</span>
 <span class="token parameter">context<span class="token punctuation">,</span>
 tag<span class="token punctuation">,</span>
 data<span class="token punctuation">,</span>
 children<span class="token punctuation">,</span>
 normalizationType<span class="token punctuation">,</span>
 alwaysNormalize</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isPrimitive</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 判断数据是否为数组或原始数据类型</span>
     normalizationType <span class="token operator">=</span> children<span class="token punctuation">;</span>
     children <span class="token operator">=</span> data<span class="token punctuation">;</span>
     data <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token comment">// ...</span>
   <span class="token keyword">return</span> <span class="token function">_createElement</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> tag<span class="token punctuation">,</span> data<span class="token punctuation">,</span> children<span class="token punctuation">,</span> normalizationType<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">_createElement</span> <span class="token punctuation">(</span>
 <span class="token parameter">context<span class="token punctuation">,</span>
 tag<span class="token punctuation">,</span>
 data<span class="token punctuation">,</span>
 children<span class="token punctuation">,</span>
 normalizationType</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isDef</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>__ob__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 判断数据不为空并且无依赖时，则作为一个空VNode节点进行处理</span>
     <span class="token function">warn</span><span class="token punctuation">(</span>
        <span class="token string">&quot;Avoid using observed data object as vnode data: &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span> <span class="token operator">+</span>
        <span class="token string">'Always create fresh vnode data objects in each render!'</span><span class="token punctuation">,</span>
        context
      <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 避免使用非响应式数据创建VNode节点，不然导致每次渲染都包含其中</span>
      <span class="token keyword">return</span> <span class="token function">createEmptyVNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 返回创建的空VNode节点</span>
   <span class="token punctuation">}</span>
   <span class="token comment">// ...</span>
   <span class="token keyword">var</span> vnode
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> tag <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// ...</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span><span class="token function">isReservedTag</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 判断标签名是否为HTML标签</span>
       vnode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VNode</span><span class="token punctuation">(</span> <span class="token comment">// 创建元素VNode节点</span>
         config<span class="token punctuation">.</span><span class="token function">parsePlatformTagName</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> children<span class="token punctuation">,</span>
         <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> context
       <span class="token punctuation">)</span>
     <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span>data <span class="token operator">||</span> <span class="token operator">!</span>data<span class="token punctuation">.</span>pre<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isDef</span><span class="token punctuation">(</span>Ctor <span class="token operator">=</span> <span class="token function">resolveAsset</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>$options<span class="token punctuation">,</span> <span class="token string">'components'</span><span class="token punctuation">,</span> tag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 判断是否为组件</span>
       vnode <span class="token operator">=</span> <span class="token function">createComponent</span><span class="token punctuation">(</span>Ctor<span class="token punctuation">,</span> data<span class="token punctuation">,</span> context<span class="token punctuation">,</span> children<span class="token punctuation">,</span> tag<span class="token punctuation">)</span> <span class="token comment">// 创建组件VNode节点</span>
     <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 其他一律当未知类型创建VNode节点</span>
       vnode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VNode</span><span class="token punctuation">(</span>
         tag<span class="token punctuation">,</span> data<span class="token punctuation">,</span> children<span class="token punctuation">,</span>
         <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> context
       <span class="token punctuation">)</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 若标签名不是字符串，则作为组件选项/构造函数创建组件</span>
     vnode <span class="token operator">=</span> <span class="token function">createComponent</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> data<span class="token punctuation">,</span> context<span class="token punctuation">,</span> children<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 判断生成的vnode是否为数组类型</span>
     <span class="token keyword">return</span> vnode
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 判断vnode是否为空</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">applyNS</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> ns<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment">// 定义当前节点的命名空间</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">registerDeepBindings</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment">// 绑定动态的style、class</span>
     <span class="token keyword">return</span> vnode
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 若为空，则直接返回一个空VNode节点</span>
     <span class="token keyword">return</span> <span class="token function">createEmptyVNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div><p>可以看到，在执行渲染方法<code>_c</code>时，最终都是返回了创建好的<code>VNode</code>节点。</p> <p>代码上可能还有些方法没有细讲，如<code>createComponent</code>，其实底层都是经过一系列的处理后得到相应的<code>VNode</code>节点。另外，我个人认为创建好的<code>VNode</code>节点终究就是一个对象形式，不会存在数组形式（若有错误，希望指出哈）。</p> <p>创建好的<code>VNode</code>节点最终经过绑定当前节点命名空间以及动态的<code>style</code>、<code>class</code>，最终将节点返回。</p> <p>最后的最后，渲染<code>Render</code>最终实现的功能就是<strong>将转化好的<code>AST</code>渲染方法，直接通过<code>VNode</code>构造函数构建相应的<code>VNode</code>节点</strong>。在这个过程中，会建立一个模板依赖 Watcher，并且将转化过程作为一个更新回调方法保存，<strong>每当响应式数据更新时，都会触发该过程，先渲染出相应的<code>VNode</code>节点，再进行<code>patch</code>比对，最后将比对的差异直接渲染成相应的真实<code>DOM</code></strong>。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vue/vue-source-explporation/【 Vue 源码分析 】编译 Compile（下）.html" class="prev">
        17. 编译 Compile（下）
      </a></span> <span class="next"><a href="/vue/vue-source-explporation/【 Vue 源码分析 】如何在更新 Patch 中进行 Diff.html">
        19. 如何在更新 Patch 中进行 Diff
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.62b9dc26.js" defer></script><script src="/assets/js/2.1177bb59.js" defer></script><script src="/assets/js/106.9ccab627.js" defer></script>
  </body>
</html>
